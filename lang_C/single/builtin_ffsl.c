#include <assert.h>

int __attribute__((noinline)) ffsl(unsigned long x)
{
	return __builtin_ffsl(x);
}

int main(void)
{
#define ASSERTFFSL(v, result)             \
	assert(ffsl(v) == result);            \
	assert(__builtin_ffsl(v) == result);

	ASSERTFFSL(0x0000000000000000UL, 0);
	ASSERTFFSL(0x0000000000000001UL, 1);
	ASSERTFFSL(0x0000000000000002UL, 2);
	ASSERTFFSL(0x0000000000000004UL, 3);
	ASSERTFFSL(0x0000000000000008UL, 4);
	ASSERTFFSL(0x0000000000000010UL, 5);
	ASSERTFFSL(0x0000000000000020UL, 6);
	ASSERTFFSL(0x0000000000000040UL, 7);
	ASSERTFFSL(0x0000000000000080UL, 8);
	ASSERTFFSL(0x0000000000000100UL, 9);
	ASSERTFFSL(0x0000000000000200UL, 10);
	ASSERTFFSL(0x0000000000000400UL, 11);
	ASSERTFFSL(0x0000000000000800UL, 12);
	ASSERTFFSL(0x0000000000001000UL, 13);
	ASSERTFFSL(0x0000000000002000UL, 14);
	ASSERTFFSL(0x0000000000004000UL, 15);
	ASSERTFFSL(0x0000000000008000UL, 16);
	ASSERTFFSL(0x0000000000010000UL, 17);
	ASSERTFFSL(0x0000000000020000UL, 18);
	ASSERTFFSL(0x0000000000040000UL, 19);
	ASSERTFFSL(0x0000000000080000UL, 20);
	ASSERTFFSL(0x0000000000100000UL, 21);
	ASSERTFFSL(0x0000000000200000UL, 22);
	ASSERTFFSL(0x0000000000400000UL, 23);
	ASSERTFFSL(0x0000000000800000UL, 24);
	ASSERTFFSL(0x0000000001000000UL, 25);
	ASSERTFFSL(0x0000000002000000UL, 26);
	ASSERTFFSL(0x0000000004000000UL, 27);
	ASSERTFFSL(0x0000000008000000UL, 28);
	ASSERTFFSL(0x0000000010000000UL, 29);
	ASSERTFFSL(0x0000000020000000UL, 30);
	ASSERTFFSL(0x0000000040000000UL, 31);
	ASSERTFFSL(0x0000000080000000UL, 32);
	ASSERTFFSL((unsigned long)-1L, 1);
	return 0;
}
